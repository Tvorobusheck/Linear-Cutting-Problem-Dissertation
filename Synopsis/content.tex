\pdfbookmark{Общая характеристика работы}{characteristic}             % Закладка pdf
\section*{Общая характеристика работы}

\newcommand{\actuality}{\pdfbookmark[1]{Актуальность}{actuality}\underline{\textbf{\actualityTXT}}}
\newcommand{\progress}{\pdfbookmark[1]{Разработанность темы}{progress}\underline{\textbf{\progressTXT}}}
\newcommand{\aim}{\pdfbookmark[1]{Цели}{aim}\underline{{\textbf\aimTXT}}}
\newcommand{\tasks}{\pdfbookmark[1]{Задачи}{tasks}\underline{\textbf{\tasksTXT}}}
\newcommand{\aimtasks}{\pdfbookmark[1]{Цели и задачи}{aimtasks}\aimtasksTXT}
\newcommand{\novelty}{\pdfbookmark[1]{Научная новизна}{novelty}\underline{\textbf{\noveltyTXT}}}
\newcommand{\influence}{\pdfbookmark[1]{Практическая значимость}{influence}\underline{\textbf{\influenceTXT}}}
\newcommand{\methods}{\pdfbookmark[1]{Методология и методы исследования}{methods}\underline{\textbf{\methodsTXT}}}
\newcommand{\defpositions}{\pdfbookmark[1]{Положения, выносимые на защиту}{defpositions}\underline{\textbf{\defpositionsTXT}}}
\newcommand{\reliability}{\pdfbookmark[1]{Достоверность}{reliability}\underline{\textbf{\reliabilityTXT}}}
\newcommand{\probation}{\pdfbookmark[1]{Апробация}{probation}\underline{\textbf{\probationTXT}}}
\newcommand{\contribution}{\pdfbookmark[1]{Личный вклад}{contribution}\underline{\textbf{\contributionTXT}}}
\newcommand{\publications}{\pdfbookmark[1]{Публикации}{publications}\underline{\textbf{\publicationsTXT}}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

%Диссертационная работа была выполнена при поддержке грантов \dots

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения,
%четырех глав, заключения и~приложения. Полный объем диссертации
%\textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список
%литературы содержит \textbf{ХХX}~наименование.

\pdfbookmark{Содержание работы}{description}                          % Закладка pdf
\section*{Содержание работы}
Во \underline{\textbf{введении}} обосновывается актуальность
исследований, проводимых в~рамках данной диссертационной работы,
приводится обзор научной литературы по~изучаемой проблеме,
формулируется цель, ставятся задачи работы, излагается научная новизна
и~практическая значимость представляемой работы.

Диссертация посвящена разработке математической модели и~алгоритма решения задачи линейного раскроя рулонных материалов в~контексте целлюлозно-бумажного производства. Рассматривается задача формирования глобального плана, включающего выпуск полуфабриката на~бумагоделательных машинах~(БДМ), продольную резку на~продольно-резательных станках~(ПРС/БРС) и~согласование операций во~времени с~учётом ограничений по~складам, переналадкам и~срокам выполнения заказов.

Актуальность темы определяется тем, что задача раскроя рулонных материалов занимает центральное место в~операционном управлении целлюлозно-бумажными предприятиями. Неэффективный раскрой приводит к~росту отходов, увеличению времени переналадок и~разбалансировке загрузки оборудования. При~типичных объёмах производства даже незначительное улучшение плана раскроя способно принести существенную экономию материальных и~временных ресурсов.

\underline{\textbf{Первая глава}} посвящена теоретической части работы и~содержит формализацию производственной задачи, обзор существующих подходов и~постановку оптимизационной задачи.

\textbf{Технологический контекст.} В~целлюлозно-бумажном производстве выделяются следующие основные этапы: подготовка целлюлозной массы, формование бумажного полотна на~бумагоделательных машинах, намотка полотна в~тамбуры (jumbo-рулоны), продольная резка тамбуров на~продольно-резательных станках и~упаковка готовой продукции. Диссертация фокусируется на~последних двух этапах: производстве тамбуров и~их раскрое.

\textbf{Основные термины и~определения.} Вводятся следующие понятия:
\begin{itemize}
    \item \textbf{Заказ}~--- запрос на~производство рулонов определённой марки бумаги, ширины и~количества с~указанием срока выполнения.
    \item \textbf{Тамбур}~--- полуфабрикат фиксированной ширины, производимый на~БДМ, который впоследствии разрезается на~рулоны.
    \item \textbf{Раскрой}~--- схема продольной резки тамбура на~рулоны; задаётся набором ширин нарезаемых рулонов.
    \item \textbf{Переналадка (перестановка ножей)}~--- операция изменения позиции режущих дисков на~ПРС при~переходе от~одного раскроя к~другому.
    \item \textbf{Склад}~--- буферная зона между БДМ и~ПРС, в~которой хранятся произведённые тамбуры до~момента их~раскроя.
    \item \textbf{Глобальный план}~--- совокупность планов производства тамбуров, планов раскроя и~календарного расписания операций.
\end{itemize}

\textbf{Критерии качества и~конфликт целей.} На~практике при~оценке плана раскроя возникает конфликт между несколькими целями. С~одной стороны, необходимо минимизировать отходы материала, что~достигается плотной упаковкой рулонов в~раскрой. С~другой стороны, желательно равномерно загрузить оборудование и~минимизировать число переналадок для~сокращения простоев. Эти~цели могут противоречить друг другу: раскрой с~минимальным отходом может потребовать частых перестановок ножей, а~минимизация переналадок может привести к~увеличению отходов.

Формулируются три критерия качества плана:
\begin{enumerate}
    \item \textbf{Минимизация суммарной ширины отходов}~$\omega(G)$~--- сумма неиспользованных частей ширины тамбуров по~всем раскроям.
    \item \textbf{Минимизация максимального числа раскроев на~одном ПРС}~$\varphi(G)$~--- показатель сбалансированности загрузки оборудования.
    \item \textbf{Минимизация общего количества перестановок ножей}~$\tau(\overline{\overline{Y}})$~--- сумма переналадок по~всем ПРС.
\end{enumerate}

Критерии упорядочены по~приоритету: отходы важнее балансировки, балансировка важнее переналадок. Это~позволяет применять лексикографическую минимизацию: сначала минимизируется первый критерий, затем среди решений с~оптимальным значением первого критерия минимизируется второй и~так далее. Альтернативно может использоваться взвешенная сумма критериев с~коэффициентами, отражающими предпочтения лица, принимающего решения.

Векторная целевая функция имеет вид:
\[
\mu(G) = \langle \omega(G),\,\varphi(G),\,\tau(\overline{\overline{Y}}) \rangle \rightarrow \min.
\]

\textbf{Принятые допущения.} Для~формализации задачи принимаются следующие допущения:
\begin{itemize}
    \item все тамбуры одной марки бумаги имеют одинаковую ширину;
    \item время производства одного тамбура на~БДМ постоянно и~известно;
    \item время выполнения одного раскроя на~ПРС постоянно и~известно;
    \item время перестановки ножей не~зависит от~числа перемещаемых дисков;
    \item вместимость складов ограничена и~известна;
    \item порядок производства марок бумаги на~БДМ задан технологическими требованиями.
\end{itemize}

\textbf{Обзор литературы.} Задача линейного раскроя (Cutting Stock Problem, CSP) впервые была формализована в~работах Гилмора и~Гомори в~1960-х годах. Классическая постановка предполагает минимизацию числа стандартных заготовок, из~которых нарезаются изделия заданных размеров. Для~решения предложен метод генерации столбцов в~рамках декомпозиции Дантцига--Вульфа.

Точные методы решения включают:
\begin{itemize}
    \item \textbf{Метод ветвей и~границ}~--- систематический перебор с~отсечением заведомо неоптимальных ветвей.
    \item \textbf{Метод ветвей и~цен (Branch-and-Price)}~--- комбинация ветвления и~генерации столбцов, эффективная для~задач большой размерности.
    \item \textbf{Динамическое программирование}~--- применимо для~задач с~небольшим числом типов изделий.
\end{itemize}

Приближённые методы включают:
\begin{itemize}
    \item \textbf{Эвристики First Fit Decreasing (FFD) и~Best Fit Decreasing (BFD)}~--- жадные алгоритмы с~гарантированной оценкой качества.
    \item \textbf{Генетические алгоритмы}~--- эволюционные методы, позволяющие находить качественные решения для~сложных комбинаторных задач.
    \item \textbf{Алгоритмы роевого интеллекта}~--- муравьиные алгоритмы, метод роя частиц и~другие.
    \item \textbf{Локальный поиск и~метаэвристики}~--- табу-поиск, имитация отжига, переменная окрестность.
\end{itemize}

Отраслевые обобщения задачи учитывают специфику конкретных производств. В~целлюлозно-бумажной промышленности важную роль играют:
\begin{itemize}
    \item потери при~продольной резке (trim loss);
    \item ограничения на~число ножей в~одном раскрое;
    \item требования к~минимальной и~максимальной ширине отхода;
    \item интеграция раскроя с~планированием производства.
\end{itemize}

Интеграция задачи раскроя с~календарным планированием (Lot Sizing and Cutting Stock Problem) рассматривается в~работах Poldi и~Arenales, Gramani и~França. В~этих~постановках решения о~размерах партий и~схемах раскроя принимаются совместно, что~позволяет учесть временные ограничения и~ограничения на~запасы.

\textbf{Место настоящей работы.} Анализ литературы показывает, что~существующие модели, как~правило, не~учитывают одновременно:
\begin{itemize}
    \item многоуровневую структуру производства (БДМ~$\rightarrow$ склад~$\rightarrow$ ПРС);
    \item многокритериальность задачи (отходы, загрузка, переналадки);
    \item динамику складских запасов и~ограничения вместимости;
    \item согласование расписаний производства и~раскроя.
\end{itemize}
Настоящая работа направлена на~восполнение этого пробела путём разработки комплексной модели и~алгоритма её~решения.

\textbf{Формальная постановка задачи.} Введём обозначения:
\begin{itemize}
    \item $M = \{1, \ldots, m\}$~--- множество бумагоделательных машин (БДМ);
    \item $S = \{1, \ldots, s\}$~--- множество продольно-резательных станков (ПРС);
    \item $K = \{1, \ldots, k\}$~--- множество марок бумаги;
    \item $O = \{1, \ldots, n\}$~--- множество заказов;
    \item $W_j$~--- ширина тамбуров марки $j \in K$;
    \item $N_i$~--- максимальное число ножей на~ПРС $i \in S$;
    \item $C_l$~--- вместимость склада $l$;
    \item $w_o$, $q_o$, $d_o$~--- ширина, количество и~срок выполнения заказа $o \in O$.
\end{itemize}

Глобальный план $G = (\overline{\overline{X}}, \overline{\overline{Y}}, \overline{\overline{Z}})$ состоит из~трёх компонент:
\begin{itemize}
    \item $\overline{\overline{X}} = \{X_1, \ldots, X_m\}$~--- планы производства тамбуров на~каждой БДМ; план $X_i$ задаёт последовательность марок и~количество тамбуров каждой марки.
    \item $\overline{\overline{Y}} = \{Y_1, \ldots, Y_s\}$~--- планы раскроя на~каждом ПРС; план $Y_i$ задаёт последовательность раскроев, где каждый раскрой определяет набор нарезаемых рулонов.
    \item $\overline{\overline{Z}}$~--- очередь событий, определяющая порядок и~моменты времени выполнения операций производства и~раскроя.
\end{itemize}

\textbf{Ограничения задачи.} План $G$ является допустимым, если выполняются следующие условия:
\begin{enumerate}
    \item \textbf{Порядок марок}: на~каждой БДМ марки бумаги производятся в~заданном технологическом порядке (переход между марками в~обратном направлении запрещён).
    \item \textbf{Допустимость раскроев}: сумма ширин рулонов в~каждом раскрое не~превышает ширины тамбура; число рулонов в~раскрое не~превышает числа ножей на~ПРС.
    \item \textbf{Выполнение заказов}: для~каждого заказа $o$ суммарное количество нарезанных рулонов ширины $w_o$ не~менее $q_o$.
    \item \textbf{Соблюдение сроков}: все~рулоны заказа $o$ нарезаны не~позднее момента $d_o$.
    \item \textbf{Наличие тамбуров}: раскрой тамбура возможен только после его~производства и~размещения на~складе.
    \item \textbf{Вместимость складов}: в~любой момент времени количество тамбуров на~складе $l$ не~превышает $C_l$.
\end{enumerate}

\textbf{Схема производственного потока.} Производственный процесс моделируется как сеть с~узлами (БДМ, склады, ПРС) и~дугами (потоки тамбуров). Каждая БДМ производит тамбуры определённых марок, которые поступают на~связанный с~ней склад. С~каждого склада тамбуры могут направляться на~один или несколько ПРС для~раскроя. Очередь событий определяет временную координацию: когда~какая машина производит или~раскраивает какой тамбур.

\textbf{Иллюстративный пример.} Для~наглядности рассмотрим простой пример задачи. Пусть имеется тамбур шириной $W = 1000$~мм и~три заказа: $o_1$ (ширина 300~мм, 2~шт.), $o_2$ (ширина 250~мм, 3~шт.), $o_3$ (ширина 200~мм, 4~шт.). Один из~возможных раскроев: $\{300, 300, 200, 200\}$ с~отходом 0~мм. Однако такой раскрой не~покрывает все~заказы. Оптимальный план может включать несколько раскроев:
\begin{itemize}
    \item раскрой~1: $\{300, 300, 200, 200\}$, отход 0~мм;
    \item раскрой~2: $\{250, 250, 250, 200, 200\}$~--- невозможен (сумма 1150 > 1000);
    \item раскрой~2: $\{250, 250, 250, 200\}$, отход 50~мм;
    \item раскрой~3: $\{200, 200\}$~--- если нужны оставшиеся рулоны.
\end{itemize}
Данный пример демонстрирует комбинаторную природу задачи: даже для~трёх заказов число вариантов велико.

\textbf{Особые случаи и~граничные условия.} Модель корректно обрабатывает следующие граничные ситуации:
\begin{itemize}
    \item единственный заказ~--- тривиальное решение;
    \item заказ шириной, равной ширине тамбура~--- каждый рулон нарезается из~отдельного тамбура;
    \item все~заказы одной ширины~--- задача сводится к~задаче упаковки;
    \item вместимость склада равна нулю~--- синхронный режим работы;
    \item один ПРС~--- классическая задача раскроя без~балансировки.
\end{itemize}

\textbf{Вычислительная сложность.} Задача линейного раскроя является NP-трудной, что~делает точное решение для~задач реальной размерности практически невозможным за~приемлемое время. Число возможных раскроев одного тамбура экспоненциально зависит от~числа типов заказов. 

Оценим размерность пространства решений. Пусть $n$~--- число типов заказов, $W$~--- ширина тамбура, $w_{\min}$~--- минимальная ширина заказа. Тогда максимальное число рулонов в~одном раскрое: $k_{\max} = \lfloor W / w_{\min} \rfloor$. Число различных раскроев оценивается как $O(n^{k_{\max}})$, что~при~типичных значениях ($n = 50$, $k_{\max} = 6$) даёт $50^6 \approx 1.5 \cdot 10^{10}$ вариантов.

При~интеграции с~планированием производства и~учёте динамики складов сложность многократно возрастает. Необходимо учитывать:
\begin{itemize}
    \item распределение заказов по~ПРС: $O(s^n)$ вариантов, где $s$~--- число ПРС;
    \item порядок раскроев на~каждом ПРС: $O((n!)^s)$ перестановок;
    \item согласование с~производством тамбуров: зависит от~топологии системы.
\end{itemize}

Это~обосновывает выбор приближённых методов решения.

\underline{\textbf{Вторая глава}} посвящена разработке алгоритма решения задачи. Глава содержит обоснование выбора метода, описание представления решений, детальное описание генетических операторов и~алгоритма генерации расписания.

\textbf{Обоснование выбора метода.} Для~решения сформулированной задачи рассматривались различные подходы: точные методы (полный перебор, метод ветвей и~границ), конструктивные эвристики (жадные алгоритмы), метаэвристики (генетические алгоритмы, имитация отжига, табу-поиск). Выбор генетического алгоритма обусловлен следующими факторами:
\begin{itemize}
    \item NP-трудность задачи делает точные методы неприменимыми для~задач реальной размерности;
    \item сложная структура ограничений затрудняет применение классических конструктивных эвристик;
    \item генетические алгоритмы хорошо зарекомендовали себя для~задач комбинаторной оптимизации;
    \item возможность естественного кодирования решений в~виде глобальных планов;
    \item гибкость в~настройке баланса между качеством решения и~временем вычислений.
\end{itemize}

\textbf{Представление решений.} Каждая особь популяции представляет собой глобальный план~$G = (\overline{\overline{X}}, \overline{\overline{Y}}, \overline{\overline{Z}})$. Компоненты плана взаимосвязаны: изменения в~планах раскроя $\overline{\overline{Y}}$ требуют согласованных изменений в~планах производства $\overline{\overline{X}}$ (для~обеспечения достаточного количества тамбуров) и~в~очереди событий $\overline{\overline{Z}}$ (для~соблюдения временных ограничений).

План раскроя $Y_i$ для~ПРС $i$ представляется как упорядоченный список раскроев. Каждый раскрой~--- это~мультимножество ширин рулонов, нарезаемых из~одного тамбура. Порядок раскроев важен, так~как определяет последовательность переналадок.

План производства $X_j$ для~БДМ $j$ представляется как последовательность пар (марка бумаги, количество тамбуров). Порядок марок фиксирован технологическими требованиями, варьируется только количество тамбуров каждой марки.

\textbf{Генерация начальной популяции.} Начальная популяция формируется путём многократного применения алгоритма случайного построения допустимого плана. Алгоритм RandomGlobalPlan работает следующим образом:
\begin{enumerate}
    \item Для~каждого заказа определяется множество допустимых ПРС (с~учётом ширины тамбура и~числа ножей).
    \item Заказы распределяются по~ПРС случайным образом с~равномерным распределением.
    \item Для~каждого ПРС формируются раскрои: рулоны заказов группируются так, чтобы сумма ширин не~превышала ширину тамбура и~число рулонов не~превышало число ножей.
    \item Раскрои перемешиваются случайным образом для~обеспечения разнообразия популяции.
    \item На~основе планов раскроя вычисляются планы производства: определяется необходимое количество тамбуров каждой марки.
    \item Генерируется очередь событий, согласующая производство и~раскрой.
\end{enumerate}

Генерируемые планы гарантированно допустимы по~конструкции: все~ограничения проверяются на~этапе построения.

\textbf{Оператор мутации (Mutate).} Оператор мутации применяется к~плану раскроя одного ПРС и~выполняет два вида преобразований:
\begin{enumerate}
    \item \textbf{Внутренняя перестановка}: рулоны внутри каждого раскроя перемешиваются случайным образом. Это~не~меняет целевую функцию, но~изменяет структуру решения, что~может повлиять на~результаты последующих операций.
    \item \textbf{Внешняя перестановка}: раскрои переупорядочиваются случайным образом. Это~может изменить число переналадок $\tau$, так~как количество перестановок ножей зависит от~последовательности раскроев.
\end{enumerate}

Мутация сохраняет допустимость решения: ни~состав раскроев, ни~их~количество не~меняются, изменяется только порядок элементов.

\textbf{Глобальная мутация (GlobalMutate).} Глобальная мутация применяется ко~всему глобальному плану и~работает по~принципу hill climbing с~мутацией:
\begin{enumerate}
    \item Создаётся копия текущего плана $G$.
    \item К~каждому плану раскроя $Y_i$ применяется оператор Mutate.
    \item Пересчитываются планы производства $\overline{\overline{X}}$ для~согласованности.
    \item Перегенерируется очередь событий $\overline{\overline{Z}}$.
    \item Вычисляется целевая функция нового плана $\mu(G')$.
    \item Если $\mu(G') < \mu(G)$ (улучшение), новый план принимается; иначе сохраняется исходный.
\end{enumerate}

Таким образом, глобальная мутация гарантирует неухудшение решения и~реализует элемент локального поиска в~рамках генетического алгоритма.

\textbf{Оператор кроссинговера.} Классический кроссинговер (обмен частями хромосом между родителями) сложно применить к~данной задаче, так~как произвольная комбинация частей двух допустимых планов может быть недопустимой. Поэтому кроссинговер реализован как~\textbf{парный отбор (tournament selection)}:
\begin{enumerate}
    \item Из~популяции выбирается пара особей $(G_1, G_2)$.
    \item К~каждой особи применяется глобальная мутация: $G'_1 = \text{GlobalMutate}(G_1)$, $G'_2 = \text{GlobalMutate}(G_2)$.
    \item Выбирается лучшая особь: $G^* = \arg\min(\mu(G'_1), \mu(G'_2))$.
    \item Лучшая особь переходит в~следующее поколение.
\end{enumerate}

Такой подход гарантирует:
\begin{itemize}
    \item сохранение допустимости всех решений;
    \item монотонное неухудшение лучшего решения в~популяции;
    \item уменьшение размера популяции вдвое на~каждом поколении, что~обеспечивает сходимость.
\end{itemize}

\textbf{Алгоритм генетического поиска (GeneticSearch).} Основной алгоритм организован следующим образом:
\begin{enumerate}
    \item \textbf{Инициализация}: генерация начальной популяции $S_0$ размера $P$ с~помощью RandomGlobalPlan.
    \item \textbf{Итерации}: пока $|S| > 1$:
    \begin{enumerate}
        \item разбить популяцию на~пары;
        \item к~каждой паре применить кроссинговер (парный отбор);
        \item сформировать новую популяцию из~победителей.
    \end{enumerate}
    \item \textbf{Результат}: единственная оставшаяся особь~--- лучшее найденное решение.
\end{enumerate}

Число поколений составляет $\lceil \log_2 P \rceil$. На~каждом поколении размер популяции уменьшается вдвое. Общая сложность алгоритма оценивается как $O(P \log P \cdot T_{\text{eval}})$, где $T_{\text{eval}}$~--- время вычисления целевой функции одного плана.

\textbf{Алгоритм генерации очереди событий (GenerateEventQueue).} Очередь событий определяет временную координацию операций и~строится на~основе планов производства и~раскроя. Алгоритм моделирует динамику производственного процесса:
\begin{enumerate}
    \item Инициализация: все~машины свободны, склады пусты, текущее время $t = 0$.
    \item Пока не~все операции выполнены:
    \begin{enumerate}
        \item определить множество доступных операций:
        \begin{itemize}
            \item производство тамбура на~БДМ возможно, если БДМ свободна и~на~складе есть место;
            \item раскрой тамбура на~ПРС возможен, если ПРС свободен и~на~складе есть тамбур нужной марки;
        \end{itemize}
        \item если есть доступные операции~--- выбрать одну по~приоритету (предпочтение раскрою для~освобождения складов);
        \item запланировать операцию: добавить событие в~очередь, обновить состояние машин и~складов;
        \item если нет доступных операций~--- продвинуть время до~завершения ближайшей операции.
    \end{enumerate}
    \item Вернуть построенную очередь событий.
\end{enumerate}

Алгоритм гарантирует построение корректного расписания, удовлетворяющего ограничениям на~вместимость складов и~доступность ресурсов.

\textbf{Гарантии качества.} Алгоритм GeneticSearch обладает следующими свойствами:
\begin{itemize}
    \item \textbf{Допустимость}: все~решения в~популяции допустимы на~всех этапах работы алгоритма.
    \item \textbf{Монотонность}: лучшее решение в~популяции не~ухудшается от~поколения к~поколению.
    \item \textbf{Сходимость}: алгоритм гарантированно завершается за~конечное число итераций.
    \item \textbf{Качество}: итоговое решение не~хуже лучшего решения в~начальной популяции.
\end{itemize}

\textbf{Анализ сложности.} Пусть $Q$~--- число заказов, $q_{\max}$~--- максимальное количество рулонов в~заказе, $P$~--- размер популяции. Тогда:
\begin{itemize}
    \item время генерации одного плана: $O(Q \cdot q_{\max})$;
    \item время вычисления целевой функции: $O(Q \cdot q_{\max})$;
    \item число поколений: $O(\log P)$;
    \item общая сложность: $O(P \log P \cdot Q \cdot q_{\max})$.
\end{itemize}

\textbf{Пример работы алгоритма.} Для~иллюстрации работы алгоритма рассмотрена тестовая задача со~следующими параметрами:

\textit{Исходные данные:}
\begin{itemize}
    \item 5 заказов: ширины 200, 250, 300, 350, 400~мм; количества 8, 6, 10, 4, 5~рулонов соответственно; все~заказы одной марки бумаги.
    \item 2 бумагоделательные машины: БДМ-1 производит тамбуры шириной 1200~мм, БДМ-2~--- шириной 1500~мм.
    \item 3 продольно-резательных станка: ПРС-1 и~ПРС-2 работают с~тамбурами 1200~мм (до~5~ножей), ПРС-3 работает с~тамбурами 1500~мм (до~6~ножей).
    \item 2 склада: склад~1 между БДМ-1 и~ПРС-1/ПРС-2 (вместимость~10), склад~2 между БДМ-2 и~ПРС-3 (вместимость~8).
\end{itemize}

\textit{Результаты оптимизации.} Генетический алгоритм с~популяцией размером~10 за~0,2~секунды нашёл решение:

План производства:
\begin{itemize}
    \item БДМ-1: 7~тамбуров марки~A;
    \item БДМ-2: 5~тамбуров марки~A.
\end{itemize}

План раскроя:
\begin{itemize}
    \item ПРС-1: 4~раскроя (обслуживает заказы~1 и~2);
    \item ПРС-2: 3~раскроя (обслуживает заказы~3 и~4);
    \item ПРС-3: 5~раскроев (обслуживает заказ~5 и~часть заказов~1--4).
\end{itemize}

Значение целевой функции: $\mu(G) = \langle 104, 5, 10 \rangle$:
\begin{itemize}
    \item суммарный отход: 104~мм (средний отход на~раскрой~--- 8,7~мм, что~составляет менее 1\% ширины тамбура);
    \item максимальное число раскроев на~одном ПРС: 5 (на~ПРС-3);
    \item общее число перестановок ножей: 10.
\end{itemize}

Очередь событий содержит 24~события: 12~операций производства тамбуров и~12~операций раскроя. Общее время выполнения плана~--- 48~условных единиц времени.

\textbf{Исследование влияния размера популяции.} Проведены эксперименты с~различными размерами популяции: $P \in \{10, 50, 100, 200, 500\}$. Результаты показывают:
\begin{itemize}
    \item увеличение $P$ от~10 до~100 существенно улучшает качество решения;
    \item дальнейшее увеличение $P$ свыше~100 даёт незначительное улучшение при~существенном росте времени вычислений;
    \item оптимальный баланс качество/время достигается при~$P \approx 100$.
\end{itemize}

\underline{\textbf{Третья глава}} посвящена программной реализации и~экспериментальному исследованию. Глава содержит описание архитектуры программного комплекса, реализованных интерфейсов, методики тестирования и~результатов экспериментов.

\textbf{Цели программной реализации.} Программный комплекс разработан для~решения следующих задач:
\begin{itemize}
    \item автоматизация формирования планов раскроя и~производства;
    \item предоставление удобного интерфейса для~технологов и~плановиков;
    \item обеспечение возможности экспериментального исследования алгоритмов;
    \item интеграция с~существующими информационными системами предприятия через~стандартные форматы данных.
\end{itemize}

\textbf{Архитектура программного комплекса.} Для~документирования архитектуры используется модель C4 (Context, Containers, Components, Code), обеспечивающая описание системы на~разных уровнях абстракции.

На~уровне контекста система взаимодействует со~следующими акторами:
\begin{itemize}
    \item \textbf{Технолог/плановик}~--- основной пользователь, формирующий планы раскроя;
    \item \textbf{ERP-система предприятия}~--- источник данных о~заказах и~оборудовании;
    \item \textbf{Система управления производством (MES)}~--- потребитель сформированных планов.
\end{itemize}

На~уровне контейнеров выделяются следующие компоненты:
\begin{itemize}
    \item \textbf{CLI (Command Line Interface)}~--- интерфейс командной строки для~пакетной обработки и~автоматизации;
    \item \textbf{GUI (Graphical User Interface)}~--- графический интерфейс для~интерактивной работы;
    \item \textbf{Алгоритмический модуль}~--- реализация генетического алгоритма и~метода полного перебора;
    \item \textbf{Модельный слой}~--- классы, представляющие сущности предметной области;
    \item \textbf{Модуль ввода/вывода}~--- чтение и~запись данных в~форматах CSV и~Excel.
\end{itemize}

\textbf{Технологический стек.} Программная реализация выполнена на~языке Python~3.10+ с~использованием следующих библиотек:
\begin{itemize}
    \item \textbf{Pandas}~--- обработка табличных данных, агрегация и~трансформация;
    \item \textbf{OpenPyXL}~--- чтение и~запись файлов Excel (.xlsx);
    \item \textbf{Tkinter}~--- построение графического интерфейса;
    \item \textbf{argparse}~--- разбор аргументов командной строки;
    \item \textbf{pytest}~--- модульное и~интеграционное тестирование.
\end{itemize}

Выбор Python обусловлен:
\begin{itemize}
    \item развитой экосистемой библиотек для~работы с~данными;
    \item простотой прототипирования и~модификации алгоритмов;
    \item кроссплатформенностью;
    \item наличием квалифицированных специалистов.
\end{itemize}

\textbf{Интерфейс командной строки (CLI).} CLI предоставляет следующие возможности:
\begin{itemize}
    \item указание входных файлов с~заказами, машинами, ПРС, складами;
    \item выбор метода оптимизации (полный перебор или~генетический алгоритм);
    \item настройка параметров алгоритма (размер популяции, число итераций);
    \item указание выходных файлов для~сохранения результатов;
    \item вывод статистики и~значения целевой функции.
\end{itemize}

Пример вызова:
\begin{verbatim}
python main.py --orders orders.csv --machines machines.csv \
    --method genetic --population 100 --output plan.xlsx
\end{verbatim}

CLI особенно удобен для:
\begin{itemize}
    \item автоматизации расчётов в~составе production pipeline;
    \item пакетной обработки множества наборов данных;
    \item интеграции с~внешними системами через~скрипты;
    \item проведения массовых экспериментов.
\end{itemize}

\textbf{Графический интерфейс (GUI).} GUI построен на~базе Tkinter и~включает:
\begin{itemize}
    \item панель загрузки входных данных с~выбором файлов через~диалог;
    \item панель настройки параметров алгоритма;
    \item кнопку запуска оптимизации с~индикатором прогресса;
    \item панель отображения результатов: значение целевой функции, статистика;
    \item кнопку экспорта результатов в~Excel.
\end{itemize}

Сценарий работы пользователя:
\begin{enumerate}
    \item загрузка файлов с~исходными данными;
    \item выбор метода оптимизации и~настройка параметров;
    \item запуск расчёта;
    \item просмотр результатов и~статистики;
    \item экспорт плана в~Excel для~дальнейшего использования.
\end{enumerate}

\textbf{Модельный слой.} Классы модельного слоя соответствуют сущностям математической модели:
\begin{itemize}
    \item \texttt{RollOrder}~--- заказ на~рулоны (ширина, количество, марка, срок);
    \item \texttt{PaperMakingMachine}~--- бумагоделательная машина (производительность, марки);
    \item \texttt{SlittingMachine}~--- продольно-резательный станок (ширина, число ножей);
    \item \texttt{Warehouse}~--- склад (вместимость, связи с~машинами);
    \item \texttt{CuttingPlan}~--- план раскроя для~одного ПРС;
    \item \texttt{ProductionPlan}~--- план производства для~одной БДМ;
    \item \texttt{GlobalPlan}~--- глобальный план (объединяет все~компоненты);
    \item \texttt{Event}~--- событие в~очереди (тип, время, машина, тамбур).
\end{itemize}

Классы инкапсулируют логику проверки ограничений и~вычисления метрик. Например, класс \texttt{CuttingPlan} содержит методы:
\begin{itemize}
    \item \texttt{add\_cutting()}~--- добавление раскроя с~проверкой допустимости;
    \item \texttt{get\_waste()}~--- вычисление отхода;
    \item \texttt{get\_changeovers()}~--- подсчёт перестановок ножей;
    \item \texttt{shuffle()}~--- случайная перестановка раскроев (для~мутации).
\end{itemize}

\textbf{Модуль ввода/вывода.} Модуль поддерживает форматы CSV и~Excel:
\begin{itemize}
    \item \textbf{Входные данные}: таблицы заказов, машин, ПРС, складов, связей между оборудованием.
    \item \textbf{Выходные данные}: планы производства, планы раскроя, очередь событий, сводная статистика.
\end{itemize}

Формат Excel предпочтителен для~конечных пользователей благодаря:
\begin{itemize}
    \item привычному интерфейсу редактирования;
    \item возможности размещения нескольких таблиц на~разных листах;
    \item поддержке форматирования и~формул для~дополнительного анализа.
\end{itemize}

\textbf{Реализованные методы оптимизации.} Программный комплекс реализует два метода:

\textit{1.~Полный перебор (Brute Force).} Метод гарантирует нахождение оптимального решения путём перечисления всех допустимых планов. Применим для~задач малой размерности ($Q \le 20$--$30$ заказов). Используется как~эталон для~оценки качества генетического алгоритма.

\textit{2.~Генетический алгоритм.} Основной метод для~задач реальной размерности. Параметры по~умолчанию:
\begin{itemize}
    \item размер популяции: $P = 100$;
    \item число поколений: $\lceil \log_2 P \rceil = 7$;
    \item вероятность мутации: 1.0 (мутация применяется всегда).
\end{itemize}

\textbf{Методика тестирования.} Тестирование проводится на~трёх уровнях:

\textit{1.~Модульные тесты.} Проверяют корректность отдельных классов и~функций:
\begin{itemize}
    \item тесты классов модельного слоя (создание, валидация, вычисление метрик);
    \item тесты операторов генетического алгоритма (мутация, кроссинговер);
    \item тесты модуля ввода/вывода (чтение/запись различных форматов);
    \item тесты граничных условий и~обработки ошибок.
\end{itemize}

\textit{2.~Интеграционные тесты.} Проверяют взаимодействие компонентов:
\begin{itemize}
    \item полный цикл: чтение данных~$\rightarrow$ оптимизация~$\rightarrow$ запись результатов;
    \item согласованность планов производства и~раскроя;
    \item корректность очереди событий.
\end{itemize}

\textit{3.~Экспериментальная валидация.} Сравнение с~эталонными решениями:
\begin{itemize}
    \item на~малых задачах~--- сравнение с~результатами полного перебора;
    \item на~средних задачах~--- сравнение с~известными нижними оценками;
    \item на~реальных данных~--- экспертная оценка качества планов.
\end{itemize}

Общее покрытие кода тестами превышает 85\%.

\textbf{Экспериментальное исследование.} Эксперименты проводились на~трёх категориях наборов данных:

\textit{1.~Малые задачи} ($Q = 10$--$30$ заказов):
\begin{itemize}
    \item позволяют найти оптимальное решение полным перебором;
    \item используются для~верификации генетического алгоритма;
    \item отклонение от~оптимума не~превышает 3--4\%.
\end{itemize}

\textit{2.~Средние задачи} ($Q = 50$--$100$ заказов):
\begin{itemize}
    \item полный перебор неприменим (время работы~--- часы/дни);
    \item генетический алгоритм находит решения за~секунды;
    \item качество оценивается по~нижним оценкам и~сравнению с~эвристиками.
\end{itemize}

\textit{3.~Крупные задачи} ($Q = 200$--$500$ заказов):
\begin{itemize}
    \item соответствуют реальным производственным условиям;
    \item генетический алгоритм формирует планы за~минуты;
    \item качество подтверждено экспертной оценкой.
\end{itemize}

\textbf{Результаты сравнения методов.} Проведено сравнение полного перебора и~генетического алгоритма на~задачах различной размерности:

\begin{itemize}
    \item При~$Q = 20$: полный перебор~--- 12 секунд, генетический алгоритм~--- 0,1 секунды; отклонение от~оптимума~--- 0\%.
    \item При~$Q = 30$: полный перебор~--- 8 минут, генетический алгоритм~--- 0,3 секунды; отклонение~--- 2\%.
    \item При~$Q = 40$: полный перебор~--- 14 часов, генетический алгоритм~--- 0,8 секунды; отклонение~--- 3\%.
    \item При~$Q = 60$: полный перебор неприменим, генетический алгоритм~--- 2 секунды.
    \item При~$Q = 100$: генетический алгоритм~--- 8 секунд.
    \item При~$Q = 300$: генетический алгоритм~--- 3 минуты.
    \item При~$Q = 500$: генетический алгоритм~--- 12 минут.
\end{itemize}

\textbf{Влияние размера популяции.} Исследована зависимость качества решения и~времени работы от~размера популяции $P$:

\begin{itemize}
    \item При~$P = 10$: быстрое решение, но~качество нестабильное.
    \item При~$P = 50$: хорошее качество, умеренное время.
    \item При~$P = 100$: оптимальный баланс качества и~времени.
    \item При~$P = 200$--$500$: незначительное улучшение качества при~существенном росте времени.
\end{itemize}

Рекомендуемое значение: $P = 100$ для~большинства практических задач.

\textbf{Воспроизводимость результатов.} Для~обеспечения воспроизводимости экспериментов:
\begin{itemize}
    \item все~наборы данных и~скрипты включены в~репозиторий;
    \item фиксируются версии всех зависимостей;
    \item генератор случайных чисел инициализируется заданным seed;
    \item результаты документируются в~структурированном формате.
\end{itemize}

\textbf{Внедрение и~практическое применение.} Программный комплекс внедрён в~опытную эксплуатацию на~целлюлозно-бумажном предприятии. Результаты внедрения:
\begin{itemize}
    \item сокращение времени формирования плана раскроя с~нескольких часов до~нескольких минут;
    \item снижение отходов материала на~5--8\% по~сравнению с~ручным планированием;
    \item повышение равномерности загрузки оборудования;
    \item уменьшение числа переналадок на~10--15\%.
\end{itemize}

\textbf{Выводы по~главе.} Разработанный программный комплекс:
\begin{itemize}
    \item реализует предложенные алгоритмы оптимизации;
    \item предоставляет удобные интерфейсы для~различных категорий пользователей;
    \item интегрируется с~информационными системами предприятия;
    \item подтверждает эффективность разработанных методов экспериментальными результатами;
    \item обеспечивает практическую применимость для~задач реальной размерности.
\end{itemize}

\FloatBarrier
\pdfbookmark{Заключение}{conclusion}                                  % Закладка pdf
В \underline{\textbf{заключении}} приведены основные результаты работы, которые заключаются в следующем:
\input{common/concl}

\pdfbookmark{Литература}{bibliography}                                % Закладка pdf
При использовании пакета \verb!biblatex! список публикаций автора по теме
диссертации формируется в разделе <<\publications>>\ файла
\verb!common/characteristic.tex!  при помощи команды \verb!\nocite!

\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=false}}{} % не рекомендуется применять пакет микротипографики к автоматически генерируемому списку литературы
\urlstyle{rm}                               % ссылки URL обычным шрифтом
\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
    \renewcommand{\bibname}{\large \bibtitleauthor}
    \nocite{*}
    \insertbiblioauthor           % Подключаем Bib-базы
    %\insertbiblioexternal   % !!! bibtex не умеет работать с несколькими библиографиями !!!
}{% Реализация пакетом biblatex через движок biber
    % Цитирования.
    %  * Порядок перечисления определяет порядок в библиографии (только внутри подраздела, если `\insertbiblioauthorgrouped`).
    %  * Если не соблюдать порядок "как для \printbibliography", нумерация в `\insertbiblioauthor` будет кривой.
    %  * Если цитировать каждый источник отдельной командой --- найти некоторые ошибки будет проще.
    %
    %% authorvak
    \nocite{klimenko2024_prin}%
    \nocite{klimenko2025ivdon}%
    %
    %% authorwos
    \nocite{wosbib1}%
    %
    %% authorscopus
    %\nocite{klimenko2025fruct}%
    %
    %% authorprogram
    \nocite{Voronov_Klimenko_2024_patent}%
    %
    %% authorconf
    \nocite{klimenko2024moscow}%
    \nocite{klimenko2025fruct}%
    \nocite{klimenko2025itptz}%


    \ifnumgreater{\value{usefootcite}}{0}{
        \begin{refcontext}[labelprefix={}]
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \end{refcontext}
    }{
        \ifnum \totvalue{citeexternal}>0
            \begin{refcontext}[labelprefix=A]
                \ifnum \value{bibgrouped}>0
                    \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
                \else
                    \insertbiblioauthor      % Вывод всех работ автора
                \fi
            \end{refcontext}
        \else
            \ifnum \value{bibgrouped}>0
                \insertbiblioauthorgrouped    % Вывод всех работ автора, сгруппированных по источникам
            \else
                \insertbiblioauthor      % Вывод всех работ автора
            \fi
        \fi
        %  \insertbiblioauthorimportant  % Вывод наиболее значимых работ автора (определяется в файле characteristic во второй section)
        \begin{refcontext}[labelprefix={}]
            \insertbiblioexternal            % Вывод списка литературы, на которую ссылались в тексте автореферата
        \end{refcontext}
        % Невидимый библиографический список для подсчёта количества внешних публикаций
        % Используется, чтобы убрать приставку "А" у работ автора, если в автореферате нет
        % цитирований внешних источников.
        \printbibliography[heading=nobibheading, section=0, env=countexternal, keyword=biblioexternal, resetnumbers=true]%
    }
}
\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=true}}{}
\urlstyle{tt}                               % возвращаем установки шрифта ссылок URL
